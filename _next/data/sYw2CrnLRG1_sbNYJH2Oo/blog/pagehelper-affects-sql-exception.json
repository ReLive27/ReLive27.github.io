{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!h.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>s[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=>k(t(l(a!=null?r(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((x,i)=>{i.exports=_jsx_runtime});var y={};N(y,{default:()=>w,frontmatter:()=>f});var n=g(o()),f={title:\"PageHelper \\u4F7F\\u7528\\u4E0D\\u5F53\\u5F15\\u53D1\\u7684 SQL \\u51FA\\u73B0\\u4E24\\u4E2A limit\",date:new Date(1678134361e3),tags:[\"Mybatis\",\"PageHelper\"],draft:!1,authors:[\"default\"]};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",img:\"img\",code:\"code\",pre:\"pre\",ol:\"ol\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"\\u95EE\\u9898\\u63CF\\u8FF0\",children:[(0,n.jsx)(e.a,{href:\"#\\u95EE\\u9898\\u63CF\\u8FF0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u95EE\\u9898\\u63CF\\u8FF0\"]}),(0,n.jsx)(e.p,{children:\"\\u8BB0\\u5F55\\u4E00\\u6B21\\u529F\\u80FD\\u6D4B\\u8BD5\\u4E2D\\u53D1\\u73B0\\u7684\\u95EE\\u9898\\uFF0C\\u6211\\u4EEC\\u53D1\\u73B0\\u9875\\u9762\\u4E00\\u90E8\\u5206\\u63A5\\u53E3\\u6709\\u65F6\\u62A5\\u9519\\uFF0C\\u901A\\u8FC7\\u67E5\\u770B\\u540E\\u53F0\\u65E5\\u5FD7\\uFF0C\\u53D1\\u73B0\\u51FA\\u73B0\\u5927\\u91CF SQL \\u5F02\\u5E38\\u9519\\u8BEF\\uFF0CSQL \\u8BED\\u53E5\\u5305\\u542B\\u591A\\u4E2A limit\\uFF0C\\u6211\\u4EEC\\u76F4\\u63A5\\u6392\\u9664\\u4E86\\u4EBA\\u4E3A\\u7F16\\u5199\\u591A\\u4E2A SQL\\uFF0C \\u56E0\\u4E3A\\u4E00\\u822C\\u4E0D\\u4F1A\\u72AF\\u8FD9\\u79CD\\u9519\\u8BEF\\uFF0C\\u9996\\u5148\\u6211\\u4EEC\\u60F3\\u5230\\u662F\\u4E0D\\u662F Mybatis \\u62E6\\u622A\\u5668\\u6709\\u4EBA\\u6539\\u52A8\\u9020\\u6210\\u7684\\uFF0C\\u4F46\\u662F\\u53D1\\u73B0\\u5E76\\u6CA1\\u6709\\u4EFB\\u4F55\\u95EE\\u9898\\u3002\\u6700\\u7EC8\\u901A\\u8FC7\\u6392\\u67E5\\u53D1\\u73B0\\u662F\\u7531 PageHelper \\u4E0D\\u89C4\\u8303\\u4F7F\\u7528 \\u9020\\u6210\\u7684\\uFF0C\\u5E76\\u4E14\\u53D1\\u73B0\\u5DE5\\u7A0B\\u4E2D\\u5B58\\u5728\\u591A\\u5904 PageHelper \\u4F7F\\u7528\\u4E0D\\u5F53\\u3002\"}),(0,n.jsx)(e.p,{children:\"PageHelper.startPage(pageStart, pageSize) \\u4E0E Mapper \\u63A5\\u53E3\\u4E4B\\u95F4\\u5B58\\u5728\\u4E1A\\u52A1\\u903B\\u8F91\\uFF0C\\u5F53\\u4E1A\\u52A1\\u903B\\u8F91\\u51FA\\u73B0\\u5F02\\u5E38\\u6CA1\\u6709\\u6267\\u884C\\u540E\\u7EED\\u7684\\u67E5\\u8BE2\\uFF0C\\u6B64\\u65F6 PageHelper \\u7684\\u5206\\u9875\\u8BBE\\u7F6E\\u7ED1\\u5B9A\\u5728\\u8BE5\\u7EBF\\u7A0B\\u7684ThreadLocal\\u91CC\\uFF0C \\u65B0\\u7684SQL\\u67E5\\u8BE2\\u6070\\u597D\\u4F7F\\u7528\\u4E86\\u8BE5\\u7EBF\\u7A0B\\uFF0C\\u5219\\u81EA\\u52A8\\u4F7F\\u7528\\u5206\\u9875\\u67E5\\u8BE2\\u3002\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\",src:\"../static/images/blogs/pagehelper-sql-exception.png\"})}),(0,n.jsxs)(e.h2,{id:\"\\u590D\\u73B0\\u95EE\\u9898\",children:[(0,n.jsx)(e.a,{href:\"#\\u590D\\u73B0\\u95EE\\u9898\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u590D\\u73B0\\u95EE\\u9898\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6211\\u4EEC\\u521B\\u5EFA\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"UserService\"}),\" \\u7C7B\\u4E2D\\u5305\\u542B\\u4EE5\\u4E0B\\u65B9\\u6CD5:\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PageInfo\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"getUserList\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PageHelper\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"startPage\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\u6A21\\u62DF PageHelper.startPage() \\u4E0E Mapper \\u4E4B\\u95F4\\u629B\\u51FA\\u5F02\\u5E38\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"User\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\">\"})]}),\" users \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" userMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"selectList\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PageInfo\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"User\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"getUser\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" userMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"selectOne\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"LambdaQueryWrapper\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"User\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\">\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"last\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"limit 1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\u7F16\\u5199\\u6D4B\\u8BD5\\u7C7B:\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@SpringBootTest\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Sql\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/user.sql\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PageHelperTest\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Autowired\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"UserService\"}),\" userService\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment doc-comment\",children:`/**\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment doc-comment\",children:`     * \\u6D4B\\u8BD5\\u5F53PageHelper\\u4F7F\\u7528\\u4E0D\\u5F53\\u5F15\\u8D77\\u591A\\u4E2Alimit\\u5173\\u952E\\u5B57\\u7684SQL\\u9519\\u8BEF\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment doc-comment\",children:\"     */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Test\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"badSqlGrammarExceptionWhenWrongUseOfPagehelper\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Assertions\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"assertThrows\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ArithmeticException\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\" userService\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getUserList\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Assertions\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"assertThrows\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"BadSqlGrammarException\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\" userService\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getUser\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5\",children:[(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u89E3\\u51B3\\u65B9\\u6CD5\"]}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"PageHelper.startPage() \\u4E4B\\u540E\\u7D27\\u63A5\\u7740\\u8C03\\u7528select\\u67E5\\u8BE2\\u3002\"}),(0,n.jsx)(e.li,{children:\"\\u5728finally \\u4E2D\\u8C03\\u7528 PageHelper.clearPage()\"})]}),(0,n.jsxs)(e.h2,{id:\"\\u7ED3\\u8BBA\",children:[(0,n.jsx)(e.a,{href:\"#\\u7ED3\\u8BBA\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u7ED3\\u8BBA\"]}),(0,n.jsxs)(e.p,{children:[\"\\u4E0E\\u5F80\\u5E38\\u4E00\\u6837\\uFF0C\\u672C\\u6587\\u4E2D\\u4F7F\\u7528\\u7684\\u6E90\\u4EE3\\u7801\\u53EF\",(0,n.jsx)(e.a,{href:\"https://github.com/ReLive27/spring-boot-sample/tree/main/spring-boot-persistence/mybatis/src/test/java/com/relive/pagehelper\",children:\"\\u5728 GitHub \\u4E0A\"}),\"\\u83B7\\u5F97\\u3002\"]})]})}}var w=b;return y;})();\n;return Component;","toc":[{"value":"问题描述","url":"#问题描述","depth":2},{"value":"复现问题","url":"#复现问题","depth":2},{"value":"解决方法","url":"#解决方法","depth":2},{"value":"结论","url":"#结论","depth":2}],"frontMatter":{"readingTime":{"text":"2 min read","minutes":1.445,"time":86700,"words":289},"slug":"pagehelper-affects-sql-exception","fileName":"pagehelper-affects-sql-exception.mdx","title":"PageHelper 使用不当引发的 SQL 出现两个 limit","date":"2023-03-06T20:26:01.000Z","tags":["Mybatis","PageHelper"],"draft":false,"authors":["default"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.18,"time":10800,"words":36},"slug":["default"],"fileName":"default.md","name":"ReLive27","avatar":"../static/images/avatar.png","occupation":"中级软件工程师","date":null}],"prev":{"title":"Spring Security 多因素认证（MFA）","date":"2023-02-26T14:24:01.000Z","tags":["SpringSecurity"],"draft":false,"authors":["default"],"slug":"spring-security-mfa"},"next":null},"__N_SSG":true}
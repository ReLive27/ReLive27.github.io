{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var t=e=>l(e,\"__esModule\",{value:!0});var m=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),N=(e,s)=>{t(e);for(var c in s)l(e,c,{get:s[c],enumerable:!0})},k=(e,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let a of d(s))!u.call(e,a)&&a!==\"default\"&&l(e,a,{get:()=>s[a],enumerable:!(c=p(s,a))||c.enumerable});return e},g=e=>k(t(l(e!=null?r(h(e)):{},\"default\",e&&e.__esModule&&\"default\"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var o=m((b,i)=>{i.exports=_jsx_runtime});var v={};N(v,{default:()=>y,frontmatter:()=>w});var n=g(o()),w={title:\"\\u5982\\u4F55\\u7528 Vault \\u4FDD\\u62A4\\u548C\\u7BA1\\u7406 Spring Authorization Server JWT \\u5BC6\\u94A5\",date:\"2024-11-05 22:32:29\",tags:[\"SpringSecurity\",\"OAuth2\",\"HashiCorp Vault\"],draft:!1,authors:[\"default\"]};function f(e={}){let{wrapper:s}=e.components||{};return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(c,{})})):c();function c(){let a=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",strong:\"strong\",blockquote:\"blockquote\",h3:\"h3\",pre:\"pre\",code:\"code\"},e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.h2,{id:\"\\u7B80\\u4ECB\",children:[(0,n.jsx)(a.a,{href:\"#\\u7B80\\u4ECB\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u7B80\\u4ECB\"]}),(0,n.jsxs)(a.p,{children:[\"\\u5728\\u73B0\\u4EE3\\u5E94\\u7528\\u4E2D\\uFF0C\\u5B89\\u5168\\u6027\\u662F\\u9996\\u8981\\u8003\\u8651\\u56E0\\u7D20\\uFF0C\\u7279\\u522B\\u662F\\u5728\\u6D89\\u53CA\\u7528\\u6237\\u8EAB\\u4EFD\\u8BA4\\u8BC1\\u548C\\u6388\\u6743\\u7684\\u670D\\u52A1\\u4E2D\\u3002JWT\\uFF08JSON Web Token\\uFF09\\u5728 OAuth 2.0 \\u548C OpenID Connect \\u6807\\u51C6\\u4E2D\\u626E\\u6F14\\u4E86\\u91CD\\u8981\\u89D2\\u8272\\u3002\\u4F5C\\u4E3A\\u4E00\\u79CD\\u52A0\\u5BC6\\u4EE4\\u724C\\uFF0CJWT \\u901A\\u5E38\\u7528\\u4E8E\\u6807\\u8BC6\\u548C\\u9A8C\\u8BC1\\u7528\\u6237\\u6216\\u5BA2\\u6237\\u7AEF\\u7684\\u8EAB\\u4EFD\\uFF0C\\u4E0D\\u7BA1\\u662F\\u4F7F\\u7528\\u5BF9\\u79F0\\u52A0\\u5BC6\\u8FD8\\u662F\\u975E\\u5BF9\\u79F0\\u52A0\\u5BC6\\u7B97\\u6CD5\\u751F\\u6210JWT\\uFF0C\\u5BF9\\u4E8E\\u5BC6\\u94A5\\u6216\\u79C1\\u94A5\\u7684\\u5B89\\u5168\\u5B58\\u50A8\\u59CB\\u7EC8\\u662F\\u6700\\u5173\\u952E\\u7684\\u95EE\\u9898\\u3002\\u672C\\u6587\\u5C06\\u4ECB\\u7ECD\\u5982\\u4F55\\u4F7F\\u7528 \",(0,n.jsx)(a.a,{href:\"https://www.vaultproject.io/\",children:\"HashiCorp Vault\"}),\" \\u6765\\u4FDD\\u62A4\\u548C\\u7BA1\\u7406 \",(0,n.jsx)(a.a,{href:\"https://spring.io/projects/spring-authorization-server\",children:\"Spring Authorization Server\"}),\" \\u6784\\u5EFA\\u7684\\u6388\\u6743\\u670D\\u52A1\\u7684 JWT \\u5BC6\\u94A5\\uFF0C\\u901A\\u8FC7 Vault \\u7684\\u5BC6\\u94A5\\u7BA1\\u7406\\u529F\\u80FD\\uFF0C\\u786E\\u4FDD JWT \\u5BC6\\u94A5\\u7684\\u5B89\\u5168\\u6027\\u3002\"]}),(0,n.jsxs)(a.h2,{id:\"vault-\\u7B80\\u4ECB\",children:[(0,n.jsx)(a.a,{href:\"#vault-\\u7B80\\u4ECB\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Vault \\u7B80\\u4ECB\"]}),(0,n.jsx)(a.p,{children:\"Vault \\u662F\\u4E00\\u4E2A\\u4E13\\u4E3A\\u5BC6\\u94A5\\u548C\\u673A\\u5BC6\\u6570\\u636E\\u7BA1\\u7406\\u800C\\u8BBE\\u8BA1\\u7684\\u5DE5\\u5177\\uFF0C\\u652F\\u6301\\u96C6\\u4E2D\\u5316\\u7684\\u5BC6\\u94A5\\u5B58\\u50A8\\u548C\\u52A8\\u6001\\u51ED\\u636E\\u751F\\u6210\\u529F\\u80FD\\u3002Vault \\u7684\\u4E3B\\u8981\\u529F\\u80FD\\u5305\\u62EC\\uFF1A\"}),(0,n.jsxs)(a.ul,{children:[(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:\"\\u5BC6\\u94A5\\u5B58\\u50A8\"}),\"\\uFF1A\\u4F7F\\u7528\\u52A0\\u5BC6\\u65B9\\u6CD5\\u4FDD\\u62A4\\u654F\\u611F\\u6570\\u636E\\u548C\\u5BC6\\u94A5\\u3002\"]}),(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:\"\\u52A8\\u6001\\u51ED\\u636E\"}),\"\\uFF1A\\u80FD\\u591F\\u4E3A\\u4E0D\\u540C\\u7684\\u5E94\\u7528\\u751F\\u6210\\u548C\\u8F6E\\u8F6C\\u72EC\\u7ACB\\u7684\\u5BC6\\u94A5\\u3002\"]}),(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:\"\\u8BBF\\u95EE\\u63A7\\u5236\"}),\"\\uFF1A\\u57FA\\u4E8E\\u7B56\\u7565\\u7BA1\\u7406\\uFF0C\\u786E\\u4FDD\\u53EA\\u6709\\u6388\\u6743\\u5E94\\u7528\\u53EF\\u4EE5\\u8BBF\\u95EE\\u5BC6\\u94A5\\u3002\"]})]}),(0,n.jsx)(a.p,{children:\"\\u901A\\u8FC7 Spring Vault \\u5C06HashiCorp Vault\\u65E0\\u7F1D\\u96C6\\u6210\\u5230 Spring \\u5E94\\u7528\\u4E2D\\uFF0C\\u7528\\u4E8E\\u7BA1\\u7406 Spring Authorization Server \\u6388\\u6743\\u670D\\u52A1\\u7684 JWT \\u5BC6\\u94A5\\u3002\"}),(0,n.jsxs)(a.h2,{id:\"\\u5B89\\u88C5-vault\",children:[(0,n.jsx)(a.a,{href:\"#\\u5B89\\u88C5-vault\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u5B89\\u88C5 Vault\"]}),(0,n.jsx)(a.p,{children:\"\\u672C\\u793A\\u4F8B\\u4ECB\\u7ECD\\u4F7F\\u7528docker\\u5B89\\u88C5Vault\\uFF0C\\u6240\\u4EE5\\u9700\\u8981\\u4F60\\u51C6\\u5907docker\\u73AF\\u5883\\u6216\\u8005\\u901A\\u8FC7Vault\\u5B98\\u7F51\\u4ECB\\u7ECD\\u8FDB\\u884C\\u4E8C\\u8FDB\\u5236\\u5B89\\u88C5\\u3002\"}),(0,n.jsx)(a.blockquote,{children:(0,n.jsx)(a.p,{children:\"\\u8BF7\\u52FF\\u5728\\u751F\\u4EA7\\u73AF\\u5883\\u4F7F\\u7528\\u4E0B\\u8FF0\\u7B80\\u5355\\u7684\\u5B89\\u88C5\\u6B65\\u9AA4\\uFF0C\\u4F60\\u5E94\\u8BE5\\u8BBE\\u7F6E\\u8BBF\\u95EE\\u63A7\\u5236\\u7B56\\u7565\\u3002\"})}),(0,n.jsxs)(a.h3,{id:\"1-\\u62C9\\u53D6-vault-\\u955C\\u50CF\",children:[(0,n.jsx)(a.a,{href:\"#1-\\u62C9\\u53D6-vault-\\u955C\\u50CF\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"1. \\u62C9\\u53D6 Vault \\u955C\\u50CF\"]}),(0,n.jsx)(a.p,{children:\"\\u9996\\u5148\\uFF0C\\u62C9\\u53D6\\u6307\\u5B9A\\u7248\\u672C\\u7684 Vault \\u955C\\u50CF\\uFF081.13.3\\uFF09\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token function\",children:\"docker\"}),` pull vault:1.13.3\n`]})})}),(0,n.jsxs)(a.h3,{id:\"2-\\u8FD0\\u884C-vault-\\u5BB9\\u5668\",children:[(0,n.jsx)(a.a,{href:\"#2-\\u8FD0\\u884C-vault-\\u5BB9\\u5668\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"2. \\u8FD0\\u884C Vault \\u5BB9\\u5668\"]}),(0,n.jsx)(a.p,{children:\"\\u4EE5\\u5F00\\u53D1\\u6A21\\u5F0F\\u8FD0\\u884C Vault \\u5BB9\\u5668\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token function\",children:\"docker\"}),\" run --cap-add\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\"IPC_LOCK \",(0,n.jsx)(a.span,{className:\"token variable parameter\",children:\"-d\"}),\" \",(0,n.jsx)(a.span,{className:\"token variable parameter\",children:\"--name\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),`dev-vault vault:1.13.3\n`]})})}),(0,n.jsxs)(a.h3,{id:\"3\\u67E5\\u770B-vault-\\u542F\\u52A8\\u65E5\\u5FD7\",children:[(0,n.jsx)(a.a,{href:\"#3\\u67E5\\u770B-vault-\\u542F\\u52A8\\u65E5\\u5FD7\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"3.\\u67E5\\u770B Vault \\u542F\\u52A8\\u65E5\\u5FD7\"]}),(0,n.jsx)(a.p,{children:\"\\u67E5\\u770BVault\\u542F\\u52A8\\u65E5\\u5FD7\\uFF0C\\u83B7\\u53D6Root Token\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token function\",children:\"docker\"}),\" logs \",(0,n.jsx)(a.span,{className:\"token variable parameter\",children:\"-f\"}),` dev-vault\n`]})})}),(0,n.jsx)(a.p,{children:\"\\u65E5\\u5FD7\\u8F93\\u51FA\\u793A\\u4F8B\\uFF1A\"}),(0,n.jsx)(a.pre,{children:(0,n.jsxs)(a.code,{className:\"code-highlight\",children:[(0,n.jsx)(a.span,{className:\"code-line\",children:`                 Api Address: http://127.0.0.1:8200\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`                         Cgo: disabled\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`             Cluster Address: https://127.0.0.1:8201\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`                  Listener 1: tcp (addr: \"127.0.0.1:8200\", cluster address: \"127.0.0.1:8201\", max_request_duration: \"1m30s\", max_request_size: \"33554432\", tls: \"disabled\")\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`                   Log Level: info\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`                       Mlock: supported: false, enabled: false\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`               Recovery Mode: false\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`                     Storage: inmem\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`                     Version: Vault v1.13.3\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    WARNING! dev mode is enabled! In this mode, Vault runs entirely in-memory\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    and starts unsealed with a single unseal key. The root token is already\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    authenticated to the CLI, so you can immediately begin using Vault.\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    You may need to set the following environment variable:\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`        $ export VAULT_ADDR='http://127.0.0.1:8200'\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    The unseal key and root token are displayed below in case you want to\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    seal/unseal the Vault or re-authenticate.\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    Unseal Key: 1+yv+v5mz+aSCK67X6slL3ECxb4UDL8ujWZU/ONBpn0=\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    Root Token: s.XmpNPoi9sRhYtdKHaQhkHP6x\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`    Development mode should NOT be used in production installations!\n`})]})}),(0,n.jsxs)(a.h3,{id:\"4\\u914D\\u7F6E-vault-\\u5BA2\\u6237\\u7AEF\",children:[(0,n.jsx)(a.a,{href:\"#4\\u914D\\u7F6E-vault-\\u5BA2\\u6237\\u7AEF\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"4.\\u914D\\u7F6E Vault \\u5BA2\\u6237\\u7AEF\"]}),(0,n.jsx)(a.p,{children:\"\\u542F\\u52A8\\u4E00\\u4E2A\\u65B0\\u7684\\u7EC8\\u7AEF\\u4F1A\\u8BDD\\u5E76\\u8FDB\\u5165\\u5BB9\\u5668\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token function\",children:\"docker\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name builtin\",children:\"exec\"}),\" \",(0,n.jsx)(a.span,{className:\"token variable parameter\",children:\"-it\"}),` dev-vault /bin/sh\n`]})})}),(0,n.jsx)(a.p,{children:\"\\u8BBE\\u7F6E Vault \\u5730\\u5740\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name builtin\",children:\"export\"}),\" \",(0,n.jsx)(a.span,{className:\"token variable assign-left\",children:\"VAULT_ADDR\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token string\",children:\"'http://127.0.0.1:8200'\"}),`\n`]})})}),(0,n.jsx)(a.p,{children:\"\\u5C06 Root Token \\u8BBE\\u7F6E\\u4E3A\\u73AF\\u5883\\u53D8\\u91CF\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name builtin\",children:\"export\"}),\" \",(0,n.jsx)(a.span,{className:\"token variable assign-left\",children:\"VAULT_TOKEN\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"s.XmpNPoi9sRhYtdKHaQhkHP6x\"'}),`\n`]})})}),(0,n.jsx)(a.p,{children:\"5.\\u9A8C\\u8BC1 Vault \\u670D\\u52A1\\u5668\\u662F\\u5426\\u6B63\\u5728\\u8FD0\\u884C \\u5728\\u5BB9\\u5668\\u5185\\u8FD0\\u884C\\u4EE5\\u4E0B\\u547D\\u4EE4\\u68C0\\u67E5\\u670D\\u52A1\\u5668\\u72B6\\u6001\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsx)(a.span,{className:\"code-line\",children:`vault status\n`})})}),(0,n.jsx)(a.p,{children:\"\\u5982\\u679C\\u60A8\\u9047\\u5230\\u5982\\u4E0B\\u9519\\u8BEF\\uFF0C\\u8BF7\\u68C0\\u67E5VAULT_ADDR\\u73AF\\u5883\\u53D8\\u91CF\\u914D\\u7F6E\\u6B63\\u786E\\u3002\"}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:\"code-highlight\",children:(0,n.jsx)(a.span,{className:\"code-line\",children:`    Error checking seal status: Get \"https://127.0.0.1:8200/v1/sys/seal-status\": http: server gave HTTP response to HTTPS client\n`})})}),(0,n.jsxs)(a.h3,{id:\"6-\\u542F\\u7528-transit-\\u5F15\\u64CE\",children:[(0,n.jsx)(a.a,{href:\"#6-\\u542F\\u7528-transit-\\u5F15\\u64CE\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"6. \\u542F\\u7528 Transit \\u5F15\\u64CE\"]}),(0,n.jsx)(a.pre,{className:\"language-shell\",children:(0,n.jsx)(a.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"vault secrets \",(0,n.jsx)(a.span,{className:\"token class-name builtin\",children:\"enable\"}),` transit\n`]})})}),(0,n.jsxs)(a.h3,{id:\"7-\\u521B\\u5EFA\\u652F\\u6301\\u7B7E\\u540D\\u7684\\u5BC6\\u94A5\",children:[(0,n.jsx)(a.a,{href:\"#7-\\u521B\\u5EFA\\u652F\\u6301\\u7B7E\\u540D\\u7684\\u5BC6\\u94A5\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"7. \\u521B\\u5EFA\\u652F\\u6301\\u7B7E\\u540D\\u7684\\u5BC6\\u94A5\"]}),(0,n.jsx)(a.p,{children:\"\\u4F7F\\u7528 rsa-2048 \\u7C7B\\u578B\\u7684\\u5BC6\\u94A5\\uFF0C\\u4EE5\\u652F\\u6301\\u7B7E\\u540D\\u64CD\\u4F5C\\uFF1A\"}),(0,n.jsx)(a.pre,{className:\"language-bash\",children:(0,n.jsx)(a.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"vault \",(0,n.jsx)(a.span,{className:\"token function\",children:\"write\"}),\" \",(0,n.jsx)(a.span,{className:\"token variable parameter\",children:\"-f\"}),\" transit/keys/oauth2 \",(0,n.jsx)(a.span,{className:\"token variable assign-left\",children:\"type\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"rsa-2048\"'}),`\n`]})})}),(0,n.jsxs)(a.h2,{id:\"\\u5C06-spring-authorization-server-\\u914D\\u7F6E\\u4E3A\\u4F7F\\u7528-vault-\\u4E2D\\u7684\\u5BC6\\u94A5\",children:[(0,n.jsx)(a.a,{href:\"#\\u5C06-spring-authorization-server-\\u914D\\u7F6E\\u4E3A\\u4F7F\\u7528-vault-\\u4E2D\\u7684\\u5BC6\\u94A5\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u5C06 Spring Authorization Server \\u914D\\u7F6E\\u4E3A\\u4F7F\\u7528 Vault \\u4E2D\\u7684\\u5BC6\\u94A5\"]}),(0,n.jsxs)(a.p,{children:[\"\\u5728 Spring Authorization Server \\u9879\\u76EE\\u4E2D\\uFF0C\\u4FEE\\u6539 \",(0,n.jsx)(a.code,{children:\"application.yml\"}),\" \\u914D\\u7F6E\\u6587\\u4EF6\\uFF0C\\u914D\\u7F6EVault\\u670D\\u52A1\\u5730\\u5740\\uFF0C\\u6CE8\\u610Ftoken\\u4E3AVault\\u542F\\u52A8\\u65E5\\u5FD7\\u4E2D\\u7684Root Token\\u3002\"]}),(0,n.jsx)(a.pre,{className:\"language-yaml\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"spring\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"application\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"name\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" authorization\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"-\"}),`service\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"cloud\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"vault\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"scheme\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),` http\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"uri\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\"//127.0.0.1\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"8200\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"authentication\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),` token\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"token\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),\"VAULT_TOKEN\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"fail-fast\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"kv\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"enabled\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token atrule key\",children:\"backend\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),` transit\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"\\u63A5\\u4E0B\\u6765\\u6211\\u4EEC\\u9700\\u8981\\u81EA\\u5B9A\\u4E49\",(0,n.jsx)(a.code,{children:\"VaultJwtEncoder\"}),\"\\uFF0C\\u4F7F\\u7528Vault\\u751F\\u6210JWT\\u7B7E\\u540D\\u3002\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultJwtEncoder\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtEncoder\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultOperations\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwsHeader\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"DEFAULT_JWS_HEADER\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwsHeader\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"with\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SignatureAlgorithm\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"RS256\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"type\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JOSEObjectType\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"JWT\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getType\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"build\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" key \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"oauth2\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"//key\\u9700\\u8981\\u548Cvault\\u521B\\u5EFA\\u7B7E\\u540D\\u5BC6\\u94A5key\\u4FDD\\u6301\\u4E00\\u81F4\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultJwtEncoder\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultOperations\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Assert\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"notNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"vaultOperations cannot be null\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"vaultOperations \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation annotation\",children:\"@SneakyThrows\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation annotation\",children:\"@Override\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"encode\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtEncoderParameters\"}),\" parameters\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throws\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtEncodingException\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwsHeader\"}),\" headers \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" parameters\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getJwsHeader\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"headers \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            headers \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"DEFAULT_JWS_HEADER\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JWSHeader\"}),\" jwsHeader \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"convert\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"headers\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtClaimsSet\"}),\" claims \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" parameters\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getClaims\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JWTClaimsSet\"}),\" jwtClaimsSet \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"convert\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"claims\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JWSObject\"}),\" jwsObject \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JWSObject\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwsHeader\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Payload\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwtClaimsSet\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"toJSONObject\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Sign the JWS object\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" signingInput \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwsObject\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getSigningInput\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Plaintext\"}),\" plaintext \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Plaintext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"signingInput\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"with\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultTransitContext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"builder\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"build\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" signature \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"opsForTransit\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"sign\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" plaintext\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getSignature\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Attach the signature to the JWS object\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Base64URL\"}),\" signatureBase64URL \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Base64URL\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"from\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"signature\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"startsWith\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"vault:v1:\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"?\"}),\" signature\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"substring\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"9\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" signature\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        jwsObject \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JWSObject\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwsHeader\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"toBase64URL\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Payload\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwtClaimsSet\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"toJSONObject\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" signatureBase64URL\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Serialize JWS to compact format\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" jws \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" jwsObject\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"serialize\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jws\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" claims\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getIssuedAt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" claims\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getExpiresAt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" headers\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getHeaders\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" claims\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getClaims\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(a.p,{children:\"\\u5176\\u4ED6Spring Authorization Server\\u6388\\u6743\\u670D\\u52A1\\u914D\\u7F6E\\u548C\\u4E4B\\u524D\\u6587\\u7AE0\\u4E00\\u81F4\\uFF0C\\u8FD9\\u91CC\\u4E0D\\u518D\\u8D58\\u8FF0\\uFF0C\\u5177\\u4F53\\u914D\\u7F6E\\u53EF\\u4EE5\\u901A\\u8FC7\\u6587\\u672B\\u94FE\\u63A5\\u67E5\\u770B\\u6E90\\u7801\\uFF0C\\u8FD9\\u91CC\\u6211\\u4EEC\\u53EA\\u8BB2\\u8FF0\\u4E0E\\u6587\\u7AE0\\u76F8\\u5173\\u7684\\u6838\\u5FC3\\u4EE3\\u7801\\u903B\\u8F91\\u3002\"}),(0,n.jsxs)(a.h2,{id:\"\\u8D44\\u6E90\\u670D\\u52A1\\u914D\\u7F6Evault\\u8FDB\\u884C\\u9A8C\\u8BC1jwt\\u7B7E\\u540D\",children:[(0,n.jsx)(a.a,{href:\"#\\u8D44\\u6E90\\u670D\\u52A1\\u914D\\u7F6Evault\\u8FDB\\u884C\\u9A8C\\u8BC1jwt\\u7B7E\\u540D\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u8D44\\u6E90\\u670D\\u52A1\\u914D\\u7F6EVault\\u8FDB\\u884C\\u9A8C\\u8BC1JWT\\u7B7E\\u540D\"]}),(0,n.jsx)(a.p,{children:\"\\u5728\\u6211\\u4EEC\\u4F7F\\u7528Vault\\u5728\\u6388\\u6743\\u670D\\u52A1\\u751F\\u6210JWT\\u540E\\uFF0C\\u8D44\\u6E90\\u670D\\u52A1\\u4F5C\\u4E3AJWT\\u7684\\u4F7F\\u7528\\u8005\\uFF0C\\u540C\\u6837\\u9700\\u8981\\u9A8C\\u7B7E\\u903B\\u8F91\\u8FDB\\u884C\\u9A8C\\u8BC1\\u7B7E\\u540D\\uFF0C\\u5141\\u8BB8\\u5BA2\\u6237\\u7AEF\\u8BF7\\u6C42\\u901A\\u8FC7\\u3002\"}),(0,n.jsxs)(a.p,{children:[\"\\u901A\\u8FC7\\u81EA\\u5B9A\\u4E49\",(0,n.jsx)(a.code,{children:\"VaultJwtDecoder\"}),\"\\u89E3\\u6790JWT\\u7684\\u7B7E\\u540D\\u5B57\\u7B26\\u4E32\\uFF0C\\u7531Vault\\u9A8C\\u8BC1\\u7B7E\\u540D\\u662F\\u5426\\u6709\\u6548\\uFF0C\\u5F53\\u7B7E\\u540D\\u6709\\u6548\\u89E3\\u6790JWT\\u5176\\u4ED6\\u90E8\\u5206\\uFF0C\\u5F53\\u7B7E\\u540D\\u88AB\\u7BE1\\u6539\\uFF0C\\u629B\\u51FA\\u5F02\\u5E38\\u7EC8\\u6B62\\u64CD\\u4F5C\\u3002\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultJwtDecoder\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtDecoder\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" key \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"oauth2\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"OAuth2TokenValidator\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" jwtValidator \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtValidators\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"createDefault\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Converter\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Object\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Object\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" claimSetConverter \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"MappedJwtClaimSetConverter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"withDefaults\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Collections\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"emptyMap\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultOperations\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultJwtDecoder\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultOperations\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Assert\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"notNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"vaultOperations cannot be null\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"vaultOperations \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"setJwtValidator\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"OAuth2TokenValidator\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" jwtValidator\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Assert\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"notNull\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwtValidator\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"jwtValidator cannot be null\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"jwtValidator \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" jwtValidator\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation annotation\",children:\"@SneakyThrows\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation annotation\",children:\"@Override\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throws\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtException\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SignedJWT\"}),\" jwt \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"parse\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),\" createdJwt \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"createJwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" jwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"validateJwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"createdJwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SignedJWT\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"parse\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"try\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SignedJWT\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"parse\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"catch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Exception\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            log\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"trace\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Failed to parse token\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"BadJwtException\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"format\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"An error occurred while attempting to decode the Jwt: %s\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getMessage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"createJwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SignedJWT\"}),\" parsedJwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"try\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Verify signature using Vault\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" signingInput \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"parsedJwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getSigningInput\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" signature \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" parsedJwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getSignature\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"toString\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Plaintext\"}),\" plaintext \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Plaintext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"signingInput\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"with\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"VaultTransitContext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"builder\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"build\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"boolean\"}),\" isValid \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" vaultOperations\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"opsForTransit\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"verify\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" plaintext\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Signature\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"vault:v1:\"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" signature\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"!\"}),\"isValid\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JOSEException\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Token signature is not valid\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JWTClaimsSet\"}),\" jwtClaimsSet \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" parsedJwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getJWTClaimsSet\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Object\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" headers \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"LinkedHashMap\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"parsedJwt\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getHeader\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"toJSONObject\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Object\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" claims \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"claimSetConverter\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"convert\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"jwtClaimsSet\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getClaims\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Jwt\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"withTokenValue\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"token\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"headers\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"h\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                h\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"putAll\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"headers\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"claims\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"c\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                c\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"putAll\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"claims\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"build\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"catch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JOSEException\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            log\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"trace\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Failed to process JWT\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"JwtException\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"format\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"An error occurred while attempting to decode the Jwt: %s\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getMessage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"catch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Exception\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            log\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"trace\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Failed to process JWT\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getCause\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ParseException\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"BadJwtException\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"format\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"An error occurred while attempting to decode the Jwt: %s\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Malformed payload\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"BadJwtException\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"format\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"An error occurred while attempting to decode the Jwt: %s\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getMessage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`})]})}),(0,n.jsxs)(a.h2,{id:\"\\u9A8C\\u8BC1-jwt-\\u7B7E\\u540D\\u548C\\u89E3\\u5BC6\\u8FC7\\u7A0B\",children:[(0,n.jsx)(a.a,{href:\"#\\u9A8C\\u8BC1-jwt-\\u7B7E\\u540D\\u548C\\u89E3\\u5BC6\\u8FC7\\u7A0B\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u9A8C\\u8BC1 JWT \\u7B7E\\u540D\\u548C\\u89E3\\u5BC6\\u8FC7\\u7A0B\"]}),(0,n.jsx)(a.p,{children:\"\\u901A\\u8FC7 Vault \\u7684\\u5BC6\\u94A5\\u8FDB\\u884CJWT\\u7B7E\\u540D\\u548C\\u9A8C\\u8BC1\\uFF0C\\u786E\\u4FDD\\u6240\\u6709\\u7684 JWT \\u90FD\\u662F\\u901A\\u8FC7 Vault \\u4FDD\\u62A4\\u7684\\u5BC6\\u94A5\\u751F\\u6210\\u7684\\u3002\\u6211\\u4EEC\\u901A\\u8FC7\\u5B8C\\u6574\\u7684OAuth2.0\\u6388\\u6743\\u7801\\u6D41\\u7A0B\\u6765\\u9A8C\\u8BC1\\u8FD9\\u4E00\\u8FC7\\u7A0B\\u3002\"}),(0,n.jsxs)(a.p,{children:[\"\\u6D4F\\u89C8\\u5668\\u8BBF\\u95EE\\uFF1A\",(0,n.jsx)(a.a,{href:\"http://127.0.0.1:8070/client/test\",children:\"http://127.0.0.1:8070/client/test\"})]}),(0,n.jsxs)(a.h2,{id:\"\\u7ED3\\u8BBA\",children:[(0,n.jsx)(a.a,{href:\"#\\u7ED3\\u8BBA\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u7ED3\\u8BBA\"]}),(0,n.jsx)(a.p,{children:\"\\u901A\\u8FC7\\u5C06 Vault \\u96C6\\u6210\\u5230 Spring Authorization Server \\u4E2D\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u5B89\\u5168\\u5730\\u7BA1\\u7406 JWT \\u5BC6\\u94A5\\uFF0C\\u5B9E\\u73B0\\u4E86\\u5BC6\\u94A5\\u7684\\u96C6\\u4E2D\\u5B58\\u50A8\\u548C\\u8BBF\\u95EE\\u63A7\\u5236\\u3002\\u901A\\u8FC7\\u672C\\u6587\\u7684\\u4ECB\\u7ECD\\uFF0C\\u5E0C\\u671B\\u4F60\\u53EF\\u4EE5\\u5728\\u81EA\\u5DF1\\u7684\\u5E94\\u7528\\u4E2D\\u5C1D\\u8BD5\\u8FD9\\u4E00\\u65B9\\u6CD5\\uFF0C\\u4E3A\\u7528\\u6237\\u63D0\\u4F9B\\u66F4\\u5B89\\u5168\\u7684\\u8EAB\\u4EFD\\u8BA4\\u8BC1\\u670D\\u52A1\\u3002\"}),(0,n.jsxs)(a.p,{children:[\"\\u4E0E\\u5F80\\u5E38\\u4E00\\u6837\\uFF0C\\u672C\\u6587\\u4E2D\\u4F7F\\u7528\\u7684\\u6E90\\u4EE3\\u7801\\u53EF\",(0,n.jsx)(a.a,{href:\"https://github.com/ReLive27/spring-security-oauth2-sample/tree/main/oauth2-jwk-with-vault\",children:\"\\u5728 GitHub \\u4E0A\"}),\"\\u83B7\\u5F97\\u3002\"]})]})}}var y=f;return v;})();\n;return Component;","toc":[{"value":"简介","url":"#简介","depth":2},{"value":"Vault 简介","url":"#vault-简介","depth":2},{"value":"安装 Vault","url":"#安装-vault","depth":2},{"value":"1. 拉取 Vault 镜像","url":"#1-拉取-vault-镜像","depth":3},{"value":"2. 运行 Vault 容器","url":"#2-运行-vault-容器","depth":3},{"value":"3.查看 Vault 启动日志","url":"#3查看-vault-启动日志","depth":3},{"value":"4.配置 Vault 客户端","url":"#4配置-vault-客户端","depth":3},{"value":"6. 启用 Transit 引擎","url":"#6-启用-transit-引擎","depth":3},{"value":"7. 创建支持签名的密钥","url":"#7-创建支持签名的密钥","depth":3},{"value":"将 Spring Authorization Server 配置为使用 Vault 中的密钥","url":"#将-spring-authorization-server-配置为使用-vault-中的密钥","depth":2},{"value":"资源服务配置Vault进行验证JWT签名","url":"#资源服务配置vault进行验证jwt签名","depth":2},{"value":"验证 JWT 签名和解密过程","url":"#验证-jwt-签名和解密过程","depth":2},{"value":"结论","url":"#结论","depth":2}],"frontMatter":{"readingTime":{"text":"9 min read","minutes":8.49,"time":509400,"words":1698},"slug":"oauth2-vault","fileName":"oauth2-vault.mdx","title":"如何用 Vault 保护和管理 Spring Authorization Server JWT 密钥","date":"2024-11-05T22:32:29.000Z","tags":["SpringSecurity","OAuth2","HashiCorp Vault"],"draft":false,"authors":["default"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.18,"time":10800,"words":36},"slug":["default"],"fileName":"default.md","name":"ReLive27","avatar":"../static/images/avatar.png","occupation":"中级软件工程师","date":null}],"prev":{"title":"OAuth2.0 动态注册客户端","date":"2024-11-05T22:00:29.000Z","tags":["SpringSecurity","OAuth2"],"draft":false,"authors":["default"],"slug":"oauth2-dynamic-client-registration"},"next":null},"__N_SSG":true}
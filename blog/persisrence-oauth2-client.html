<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Spring Security 持久化OAuth2客户端</title><meta name="robots" content="follow, index"/><meta name="description"/><meta property="og:url" content="/blog/persisrence-oauth2-client"/><meta property="og:type" content="article"/><meta property="og:site_name" content="ReLive27 Blog"/><meta property="og:description"/><meta property="og:title" content="Spring Security 持久化OAuth2客户端"/><meta property="og:image" content="/static/images/banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/Twitter"/><meta name="twitter:title" content="Spring Security 持久化OAuth2客户端"/><meta name="twitter:description"/><meta name="twitter:image" content="/static/images/banner.png"/><link rel="canonical" href="/blog/persisrence-oauth2-client"/><meta property="article:published_time" content="2022-07-03T11:55:25.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/blog/persisrence-oauth2-client"
  },
  "headline": "Spring Security 持久化OAuth2客户端",
  "image": [
    {
      "@type": "ImageObject",
      "url": "/static/images/banner.png"
    }
  ],
  "datePublished": "2022-07-03T11:55:25.000Z",
  "dateModified": "2022-07-03T11:55:25.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "ReLive27"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "ReLive27",
    "logo": {
      "@type": "ImageObject",
      "url": "/static/images/logo.png"
    }
  }
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/cb219a7ccfc94aea.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cb219a7ccfc94aea.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-c02bf62501b28183.js" defer=""></script><script src="/_next/static/chunks/main-af7d71956f213330.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8d084309d9e41ee0.js" defer=""></script><script src="/_next/static/chunks/675-415f2ef004e9374e.js" defer=""></script><script src="/_next/static/chunks/410-1fac91fa0a8ba801.js" defer=""></script><script src="/_next/static/chunks/712-0fe85dfe47f05b2b.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/qOb3mFNpU4K4sfK66WJU7/_buildManifest.js" defer=""></script><script src="/_next/static/qOb3mFNpU4K4sfK66WJU7/_ssgManifest.js" defer=""></script><script src="/_next/static/qOb3mFNpU4K4sfK66WJU7/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="ReLive27" href="/"><div class="flex items-center justify-between"><div class="hidden h-6 text-2xl font-semibold sm:block">ReLive27</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/">主页Home</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">博客Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">专栏Column</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">项目Projects</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">关于About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/">主页Home</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">博客Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">专栏Column</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">项目Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">关于About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-07-03T11:55:25.000Z">2022年7月3日星期日</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Spring Security 持久化OAuth2客户端</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="static/images/avatar.png?imwidth=48 1x, static/images/avatar.png?imwidth=96 2x" src="static/images/avatar.png?imwidth=96" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">ReLive27</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h2 id="spring-security-持久化oauth2客户端"><a href="#spring-security-持久化oauth2客户端" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Spring Security 持久化OAuth2客户端</h2><p>在<a target="_blank" rel="noopener noreferrer" href="https://relive27.github.io/2022/06/26/spring-security-oauth2-jwt/">之前文章中</a>介绍过了客户端通过向授权服务器（使用<a target="_blank" rel="noopener noreferrer" href="https://spring.io/projects/spring-authorization-server#learn">Spring Authorization Server</a>）请求授权并访问资源服务器受保护资源。在创建OAuth2客户端服务时，客户端注册通常从<code>application.yml </code>文件中自动加载，Spring 自动配置使用<code>OAuth2ClientProperties</code>在<code>spring.security.oauth2.client.registration.[registrationId]</code>创建一个<code>ClientRegistration</code>并实例化<code>ClientRegistrationRepository</code>。</p><p>以下Spring自动配置<code>OAuth2ClientRegistrationRepositoryConfiguration</code>代码如下：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token punctuation annotation">@Configuration</span><span class="token punctuation">(</span>
</span><span class="code-line">    proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation annotation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">OAuth2ClientProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation annotation">@Conditional</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ClientsConfiguredCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">OAuth2ClientRegistrationRepositoryConfiguration</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token class-name">OAuth2ClientRegistrationRepositoryConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token punctuation annotation">@Bean</span>
</span><span class="code-line">    <span class="token punctuation annotation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ClientRegistrationRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token class-name">InMemoryClientRegistrationRepository</span> <span class="token function">clientRegistrationRepository</span><span class="token punctuation">(</span><span class="token class-name">OAuth2ClientProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientRegistration</span><span class="token punctuation">&gt;</span></span> registrations <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token class-name">OAuth2ClientPropertiesRegistrationAdapter</span><span class="token punctuation">.</span><span class="token function">getClientRegistrations</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryClientRegistrationRepository</span><span class="token punctuation">(</span>registrations<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>如您所见，<code>ClientRegistrationRepository</code>默认实现并仅有一个实现类是<code>InMemoryClientRegistrationRepository</code>，它将ClientRegistration存储在内存中，而在生产环境中此方式可能会有一定局限性。</p><p>在本文中您将了解如何通过扩展ClientRegistrationRepository实现OAuth2客户端持久化。</p><h3 id="oauth2客户端服务实现"><a href="#oauth2客户端服务实现" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>OAuth2客户端服务实现</h3><p>在本节中，您将创建一个简单的OAuth2客户端服务，并通过数据库存储OAuth2客户端信息，现在看代码！</p><h4 id="maven"><a href="#maven" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>maven</h4><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.6.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.6.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.6.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-oauth2-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.6.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-webflux<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.projectreactor.netty<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>reactor-netty<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line">...
</span></code></pre></div><h4 id="配置"><a href="#配置" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>配置</h4><p>首先让我们通过application.yml配置服务端口信息和数据库连接信息：</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">server</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">port</span><span class="token punctuation">:</span> <span class="token number">8070</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token atrule key">spring</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">datasource</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">druid</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">db-type</span><span class="token punctuation">:</span> mysql
</span><span class="code-line">      <span class="token atrule key">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
</span><span class="code-line">      <span class="token atrule key">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/persistence_oauth2_client<span class="token punctuation">?</span>createDatabaseIfNotExist=true<span class="token important">&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true</span>
</span><span class="code-line">      <span class="token atrule key">username</span><span class="token punctuation">:</span> &lt;&lt;username<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> <span class="token comment"># 修改用户名</span>
</span><span class="code-line">      <span class="token atrule key">password</span><span class="token punctuation">:</span> &lt;&lt;password<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> <span class="token comment"># 修改密码</span>
</span></code></pre></div><p>接下来我们根据<code>ClientRegistration</code>来创建数据库表用于存储OAuth2客户端信息：</p><div class="relative"><pre><code class="code-highlight language-sql"><span class="code-line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>oauth2_registered_client<span class="token punctuation">`</span></span>
</span><span class="code-line"><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>registration_id<span class="token punctuation">`</span></span>                 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>client_id<span class="token punctuation">`</span></span>                       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>client_secret<span class="token punctuation">`</span></span>                   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>  <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>client_authentication_method<span class="token punctuation">`</span></span>    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>authorization_grant_type<span class="token punctuation">`</span></span>        <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>client_name<span class="token punctuation">`</span></span>                     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>  <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>redirect_uri<span class="token punctuation">`</span></span>                    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>scopes<span class="token punctuation">`</span></span>                          <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>authorization_uri<span class="token punctuation">`</span></span>               <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>token_uri<span class="token punctuation">`</span></span>                       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>jwk_set_uri<span class="token punctuation">`</span></span>                     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>issuer_uri<span class="token punctuation">`</span></span>                      <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>user_info_uri<span class="token punctuation">`</span></span>                   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>user_info_authentication_method<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>user_name_attribute_name<span class="token punctuation">`</span></span>        <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token identifier"><span class="token punctuation">`</span>configuration_metadata<span class="token punctuation">`</span></span>          <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>registration_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8mb4_0900_ai_ci<span class="token punctuation">;</span>
</span></code></pre></div><p>下面将是我们通过实现<em>ClientRegistrationRepository</em>扩展的<em>JdbcClientRegistrationRepository</em>：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcClientRegistrationRepository</span> <span class="token keyword">implements</span> <span class="token class-name">ClientRegistrationRepository</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">COLUMN_NAMES</span> <span class="token operator">=</span> <span class="token string">&quot;registration_id,client_id,client_secret,client_authentication_method,authorization_grant_type,client_name,redirect_uri,scopes,authorization_uri,token_uri,jwk_set_uri,issuer_uri,user_info_uri,user_info_authentication_method,user_name_attribute_name,configuration_metadata&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;oauth2_registered_client&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LOAD_CLIENT_REGISTERED_SQL</span> <span class="token operator">=</span> <span class="token string">&quot;SELECT &quot;</span> <span class="token operator">+</span> <span class="token constant">COLUMN_NAMES</span> <span class="token operator">+</span> <span class="token string">&quot; FROM &quot;</span> <span class="token operator">+</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">+</span> <span class="token string">&quot; WHERE &quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">INSERT_CLIENT_REGISTERED_SQL</span> <span class="token operator">=</span> <span class="token string">&quot;INSERT INTO &quot;</span> <span class="token operator">+</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> <span class="token constant">COLUMN_NAMES</span> <span class="token operator">+</span> <span class="token string">&quot;) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">UPDATE_CLIENT_REGISTERED_SQL</span> <span class="token operator">=</span> <span class="token string">&quot;UPDATE &quot;</span> <span class="token operator">+</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">+</span> <span class="token string">&quot; SET client_id = ?,client_secret = ?,client_authentication_method = ?,authorization_grant_type = ?,client_name = ?,redirect_uri = ?,scopes = ?,authorization_uri = ?,token_uri = ?,jwk_set_uri = ?,issuer_uri = ?,user_info_uri = ?,user_info_authentication_method = ?,user_name_attribute_name = ? WHERE registration_id = ?&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JdbcOperations</span> jdbcOperations<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientRegistration</span><span class="token punctuation">&gt;</span></span> clientRegistrationRowMapper<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientRegistration</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">SqlParameterValue</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> clientRegistrationListParametersMapper<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">JdbcClientRegistrationRepository</span><span class="token punctuation">(</span><span class="token class-name">JdbcOperations</span> jdbcOperations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>jdbcOperations<span class="token punctuation">,</span> <span class="token string">&quot;JdbcOperations can not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcOperations <span class="token operator">=</span> jdbcOperations<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>clientRegistrationRowMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClientRegistrationRowMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>clientRegistrationListParametersMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClientRegistrationParametersMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token punctuation annotation">@Override</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">ClientRegistration</span> <span class="token function">findByRegistrationId</span><span class="token punctuation">(</span><span class="token class-name">String</span> registrationId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>registrationId<span class="token punctuation">,</span> <span class="token string">&quot;registrationId cannot be empty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findBy</span><span class="token punctuation">(</span><span class="token string">&quot;registration_id = ?&quot;</span><span class="token punctuation">,</span> registrationId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token class-name">ClientRegistration</span> <span class="token function">findBy</span><span class="token punctuation">(</span><span class="token class-name">String</span> filter<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientRegistration</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcOperations<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token constant">LOAD_CLIENT_REGISTERED_SQL</span> <span class="token operator">+</span> filter<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clientRegistrationRowMapper<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> result<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">ClientRegistration</span> clientRegistration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">,</span> <span class="token string">&quot;clientRegistration cannot be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name">ClientRegistration</span> existingClientRegistration <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findByRegistrationId</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">.</span><span class="token function">getRegistrationId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>existingClientRegistration <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRegisteredClient</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">insertClientRegistration</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">updateRegisteredClient</span><span class="token punctuation">(</span><span class="token class-name">ClientRegistration</span> clientRegistration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SqlParameterValue</span><span class="token punctuation">&gt;</span></span> parameterValues <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clientRegistrationListParametersMapper<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name">PreparedStatementSetter</span> statementSetter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArgumentPreparedStatementSetter</span><span class="token punctuation">(</span>parameterValues<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcOperations<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token constant">UPDATE_CLIENT_REGISTERED_SQL</span><span class="token punctuation">,</span> statementSetter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">insertClientRegistration</span><span class="token punctuation">(</span><span class="token class-name">ClientRegistration</span> clientRegistration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SqlParameterValue</span><span class="token punctuation">&gt;</span></span> parameterValues <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clientRegistrationListParametersMapper<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>clientRegistration<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name">PreparedStatementSetter</span> statementSetter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArgumentPreparedStatementSetter</span><span class="token punctuation">(</span>parameterValues<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcOperations<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token constant">INSERT_CLIENT_REGISTERED_SQL</span><span class="token punctuation">,</span> statementSetter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">//...省略部分代码</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>之后我们将创建<code>SecurityConfig</code>安全配置类，在此类中创建OAuth2 Client所需特定的Bean。首先我们将实例化上述自定义的<em>JdbcClientRegistrationRepository</em>：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token punctuation annotation">@Bean</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token class-name">ClientRegistrationRepository</span> <span class="token function">clientRegistrationRepository</span><span class="token punctuation">(</span><span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcClientRegistrationRepository</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><strong>ClientRegistration</strong>：表示使用 OAuth 2.0 或 OpenID Connect (OIDC) 注册的客户端。它包含有关客户端的所有基本信息，例如客户端 ID、客户端机密、授权类型和各种 URI。</p><p><strong>ClientRegistrationRepository</strong>：这是一个包含<em>ClientRegistrations</em>并负责持久化。</p><br/><p>接下来配置OAuth2AuthorizedClient管理类<em>OAuth2AuthorizedClientService</em>：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token punctuation annotation">@Bean</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token class-name">OAuth2AuthorizedClientService</span> <span class="token function">authorizedClientService</span><span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token class-name">ClientRegistrationRepository</span> clientRegistrationRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcOAuth2AuthorizedClientService</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">,</span> clientRegistrationRepository<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><strong>OAuth2AuthorizedClient</strong>：表示授权客户端。这是一个包含客户端注册但添加身份验证信息的组合类。</p><p><strong>OAuth2AuthorizedClientService</strong>：负责<code>OAuth2AuthorizedClient</code>在 Web 请求之间进行持久化。</p><br/><p>定义<em>JdbcOAuth2AuthorizedClientService</em>需要创建所需数据表，你可以在<a target="_blank" rel="noopener noreferrer" href="https://docs.spring.io/spring-security/site/docs/5.4.5/reference/html5/#dbschema-oauth2-client">OAuth2 Client Schema</a>中获取表定义：</p><div class="relative"><pre><code class="code-highlight language-sql"><span class="code-line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> oauth2_authorized_client
</span><span class="code-line"><span class="token punctuation">(</span>
</span><span class="code-line">    client_registration_id  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>                            <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    principal_name          <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>                            <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    access_token_type       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>                            <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    access_token_value      <span class="token keyword">blob</span>                                    <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    access_token_issued_at  <span class="token keyword">timestamp</span>                               <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    access_token_expires_at <span class="token keyword">timestamp</span>                               <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    access_token_scopes     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    refresh_token_value     <span class="token keyword">blob</span>          <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    refresh_token_issued_at <span class="token keyword">timestamp</span>     <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    created_at              <span class="token keyword">timestamp</span>     <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>client_registration_id<span class="token punctuation">,</span> principal_name<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>接下来配置<em>OAuth2AuthorizedClientRepository</em>容器类：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token punctuation annotation">@Bean</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token class-name">OAuth2AuthorizedClientRepository</span> <span class="token function">authorizedClientRepository</span><span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token class-name">OAuth2AuthorizedClientService</span> authorizedClientService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AuthenticatedPrincipalOAuth2AuthorizedClientRepository</span><span class="token punctuation">(</span>authorizedClientService<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><strong>OAuth2AuthorizedClientRepository</strong>:是一个容器类，用于在请求之间保存和持久化授权客户端。这里通过<em>JdbcOAuth2AuthorizedClientService</em>将客户端存储在数据库中。</p><br/><p>接下来实例化包含授权流程的逻辑的管理器类：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token punctuation annotation">@Bean</span>
</span><span class="code-line"><span class="token class-name">OAuth2AuthorizedClientManager</span> <span class="token function">authorizedClientManager</span><span class="token punctuation">(</span><span class="token class-name">ClientRegistrationRepository</span> clientRegistrationRepository<span class="token punctuation">,</span>
</span><span class="code-line">                                                      <span class="token class-name">OAuth2AuthorizedClientRepository</span> authorizedClientRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token class-name">OAuth2AuthorizedClientProvider</span> authorizedClientProvider <span class="token operator">=</span> <span class="token class-name">OAuth2AuthorizedClientProviderBuilder</span>
</span><span class="code-line">    <span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">.</span><span class="token function">authorizationCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">.</span><span class="token function">refreshToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token class-name">DefaultOAuth2AuthorizedClientManager</span> authorizedClientManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultOAuth2AuthorizedClientManager</span><span class="token punctuation">(</span>clientRegistrationRepository<span class="token punctuation">,</span> authorizedClientRepository<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  authorizedClientManager<span class="token punctuation">.</span><span class="token function">setAuthorizedClientProvider</span><span class="token punctuation">(</span>authorizedClientProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> authorizedClientManager<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><strong>OAuth2AuthorizedClientManager</strong>：是包含处理授权流程的逻辑的管理器类。最重要的是，它使用<code>OAuth2AuthorizedClientProvider</code>处理不同授权类型和 OAuth 2.0 提供者的实际请求逻辑。它还委托<code>OAuth2AuthorizedClientRepository</code>在客户端授权成功或失败时调用成功或失败处理程序。</p><br/><p>现在让我们创建一个WebClient实例用于向资源服务器执行HTTP请求：</p><div class="relative"><pre><code class="code-highlight"><span class="code-line"> @Bean
</span><span class="code-line">    WebClient webClient(OAuth2AuthorizedClientManager authorizedClientManager) {
</span><span class="code-line">        ServletOAuth2AuthorizedClientExchangeFilterFunction oauth2Client = new ServletOAuth2AuthorizedClientExchangeFilterFunction(authorizedClientManager);
</span><span class="code-line">        return WebClient.builder()
</span><span class="code-line">                .apply(oauth2Client.oauth2Configuration())
</span><span class="code-line">                .build();
</span><span class="code-line">    }
</span></code></pre></div><br/><p>最后，我们将配置Spring Security安全配置：</p><div class="relative"><pre><code class="code-highlight"><span class="code-line"> @Bean
</span><span class="code-line">    SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
</span><span class="code-line">        http
</span><span class="code-line">                .authorizeRequests(authorizeRequests -&gt;
</span><span class="code-line">                        authorizeRequests.anyRequest().authenticated()
</span><span class="code-line">                )
</span><span class="code-line">                .formLogin(login -&gt; {
</span><span class="code-line">                    login.loginPage(&quot;/login&quot;).permitAll();
</span><span class="code-line">                })
</span><span class="code-line">                .oauth2Client(withDefaults());
</span><span class="code-line">        return http.build();
</span><span class="code-line">    }
</span></code></pre></div><p>这里配置所有请求需要认证授权，提供Form表单认证方式，并通过<a target="_blank" rel="noopener noreferrer" href="https://www.thymeleaf.org/">thymeleaf</a>自定义登录模版，此处代码并不再本文讲解范围内，以下将不展示具体细节。</p><h4 id="访问资源列表"><a href="#访问资源列表" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>访问资源列表</h4><p>我们将创建一个<em>PersistenceClientController</em>，并使用WebClient向资源服务器发起HTTP请求：</p><div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token punctuation annotation">@RestController</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersistenceClientController</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token punctuation annotation">@Autowired</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token class-name">WebClient</span> webClient<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token punctuation annotation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/client/test&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getArticles</span><span class="token punctuation">(</span><span class="token punctuation annotation">@RegisteredOAuth2AuthorizedClient</span><span class="token punctuation">(</span><span class="token string">&quot;messaging-client-authorization-code&quot;</span><span class="token punctuation">)</span> <span class="token class-name">OAuth2AuthorizedClient</span> authorizedClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>webClient
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8090/resource/article&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token function">oauth2AuthorizedClient</span><span class="token punctuation">(</span>authorizedClient<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><br/><p>在本文中，您看到了OAuth2客户端服务持久化到数据库的实现方法，对于其他授权服务器和资源服务器配置将不再讲解，如果您感兴趣可以参考 此文章<a target="_blank" rel="noopener noreferrer" href="https://relive27.github.io/2022/06/26/spring-security-oauth2-jwt/">将JWT与Spring Security OAuth2结合使用</a>。</p><h3 id="结论"><a href="#结论" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>结论</h3><p>与往常一样，本文中使用的源代码可<a target="_blank" rel="noopener noreferrer" href="https://github.com/ReLive27/spring-security-oauth2-sample/tree/main/oauth2-persistence-client">在 GitHub 上</a>获得。</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=%2Fblog%2Fpersisrence-oauth2-client">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/ReLive27/relive27.com/blob/master/data/blog/persisrence-oauth2-client.mdx">View on GitHub</a></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/oauth2">OAuth2</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/springsecurity">SpringSecurity</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/custom-oauth2-consent-page">自定义OAuth2授权同意页面</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/oauth2-client-model">Spring Security OAuth2客户端凭据授权</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:re_live27@163.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/ReLive27"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://facebook.com"><span class="sr-only">facebook</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://youtube.com"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.499 6.203a3.008 3.008 0 0 0-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 0 0-2.088 2.09A31.258 31.26 0 0 0 0 12.01a31.258 31.26 0 0 0 .523 5.785 3.008 3.008 0 0 0 2.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 0 0 2.089-2.09 31.258 31.26 0 0 0 .5-5.784 31.258 31.26 0 0 0-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/Twitter"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>© 2022</div><div> • </div><a href="/">ReLive27</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var l=a=\u003et(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!m.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026t(a,e,{get:()=\u003es[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=\u003ek(l(t(a!=null?r(h(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((f,i)=\u003e{i.exports=_jsx_runtime});var R={};N(R,{default:()=\u003eb,frontmatter:()=\u003ey});var n=g(o()),y={title:\"Spring Security \\u6301\\u4E45\\u5316OAuth2\\u5BA2\\u6237\\u7AEF\",date:new Date(1656849325e3),tags:[\"OAuth2\",\"SpringSecurity\"],draft:!1,authors:[\"default\"]};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",pre:\"pre\",h3:\"h3\",h4:\"h4\",em:\"em\",strong:\"strong\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"spring-security-\\u6301\\u4E45\\u5316oauth2\\u5BA2\\u6237\\u7AEF\",children:[(0,n.jsx)(e.a,{href:\"#spring-security-\\u6301\\u4E45\\u5316oauth2\\u5BA2\\u6237\\u7AEF\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Spring Security \\u6301\\u4E45\\u5316OAuth2\\u5BA2\\u6237\\u7AEF\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5728\",(0,n.jsx)(e.a,{href:\"https://relive27.github.io/2022/06/26/spring-security-oauth2-jwt/\",children:\"\\u4E4B\\u524D\\u6587\\u7AE0\\u4E2D\"}),\"\\u4ECB\\u7ECD\\u8FC7\\u4E86\\u5BA2\\u6237\\u7AEF\\u901A\\u8FC7\\u5411\\u6388\\u6743\\u670D\\u52A1\\u5668\\uFF08\\u4F7F\\u7528\",(0,n.jsx)(e.a,{href:\"https://spring.io/projects/spring-authorization-server#learn\",children:\"Spring Authorization Server\"}),\"\\uFF09\\u8BF7\\u6C42\\u6388\\u6743\\u5E76\\u8BBF\\u95EE\\u8D44\\u6E90\\u670D\\u52A1\\u5668\\u53D7\\u4FDD\\u62A4\\u8D44\\u6E90\\u3002\\u5728\\u521B\\u5EFAOAuth2\\u5BA2\\u6237\\u7AEF\\u670D\\u52A1\\u65F6\\uFF0C\\u5BA2\\u6237\\u7AEF\\u6CE8\\u518C\\u901A\\u5E38\\u4ECE\",(0,n.jsx)(e.code,{children:\"application.yml \"}),\"\\u6587\\u4EF6\\u4E2D\\u81EA\\u52A8\\u52A0\\u8F7D\\uFF0CSpring \\u81EA\\u52A8\\u914D\\u7F6E\\u4F7F\\u7528\",(0,n.jsx)(e.code,{children:\"OAuth2ClientProperties\"}),\"\\u5728\",(0,n.jsx)(e.code,{children:\"spring.security.oauth2.client.registration.[registrationId]\"}),\"\\u521B\\u5EFA\\u4E00\\u4E2A\",(0,n.jsx)(e.code,{children:\"ClientRegistration\"}),\"\\u5E76\\u5B9E\\u4F8B\\u5316\",(0,n.jsx)(e.code,{children:\"ClientRegistrationRepository\"}),\"\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u4EE5\\u4E0BSpring\\u81EA\\u52A8\\u914D\\u7F6E\",(0,n.jsx)(e.code,{children:\"OAuth2ClientRegistrationRepositoryConfiguration\"}),\"\\u4EE3\\u7801\\u5982\\u4E0B\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Configuration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    proxyBeanMethods \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@EnableConfigurationProperties\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2ClientProperties\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Conditional\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientsConfiguredCondition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2ClientRegistrationRepositoryConfiguration\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2ClientRegistrationRepositoryConfiguration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@ConditionalOnMissingBean\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"InMemoryClientRegistrationRepository\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"clientRegistrationRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2ClientProperties\"}),\" properties\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" registrations \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ArrayList\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2ClientPropertiesRegistrationAdapter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getClientRegistrations\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"properties\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"values\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"InMemoryClientRegistrationRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"registrations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u5982\\u60A8\\u6240\\u89C1\\uFF0C\",(0,n.jsx)(e.code,{children:\"ClientRegistrationRepository\"}),\"\\u9ED8\\u8BA4\\u5B9E\\u73B0\\u5E76\\u4EC5\\u6709\\u4E00\\u4E2A\\u5B9E\\u73B0\\u7C7B\\u662F\",(0,n.jsx)(e.code,{children:\"InMemoryClientRegistrationRepository\"}),\"\\uFF0C\\u5B83\\u5C06ClientRegistration\\u5B58\\u50A8\\u5728\\u5185\\u5B58\\u4E2D\\uFF0C\\u800C\\u5728\\u751F\\u4EA7\\u73AF\\u5883\\u4E2D\\u6B64\\u65B9\\u5F0F\\u53EF\\u80FD\\u4F1A\\u6709\\u4E00\\u5B9A\\u5C40\\u9650\\u6027\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u5728\\u672C\\u6587\\u4E2D\\u60A8\\u5C06\\u4E86\\u89E3\\u5982\\u4F55\\u901A\\u8FC7\\u6269\\u5C55ClientRegistrationRepository\\u5B9E\\u73B0OAuth2\\u5BA2\\u6237\\u7AEF\\u6301\\u4E45\\u5316\\u3002\"}),(0,n.jsxs)(e.h3,{id:\"oauth2\\u5BA2\\u6237\\u7AEF\\u670D\\u52A1\\u5B9E\\u73B0\",children:[(0,n.jsx)(e.a,{href:\"#oauth2\\u5BA2\\u6237\\u7AEF\\u670D\\u52A1\\u5B9E\\u73B0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"OAuth2\\u5BA2\\u6237\\u7AEF\\u670D\\u52A1\\u5B9E\\u73B0\"]}),(0,n.jsx)(e.p,{children:\"\\u5728\\u672C\\u8282\\u4E2D\\uFF0C\\u60A8\\u5C06\\u521B\\u5EFA\\u4E00\\u4E2A\\u7B80\\u5355\\u7684OAuth2\\u5BA2\\u6237\\u7AEF\\u670D\\u52A1\\uFF0C\\u5E76\\u901A\\u8FC7\\u6570\\u636E\\u5E93\\u5B58\\u50A8OAuth2\\u5BA2\\u6237\\u7AEF\\u4FE1\\u606F\\uFF0C\\u73B0\\u5728\\u770B\\u4EE3\\u7801\\uFF01\"}),(0,n.jsxs)(e.h4,{id:\"maven\",children:[(0,n.jsx)(e.a,{href:\"#maven\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"maven\"]}),(0,n.jsx)(e.pre,{className:\"language-xml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-xml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework.boot\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-boot-starter-web\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"2.6.7\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework.boot\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-boot-starter-data-jdbc\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"2.6.7\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework.boot\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-boot-starter-security\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"2.6.7\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework.boot\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-boot-starter-oauth2-client\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"2.6.7\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-webflux\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"5.3.9\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"io.projectreactor.netty\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"reactor-netty\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"1.0.9\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"mysql\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"mysql-connector-java\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"8.0.21\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"version\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`...\n`})]})}),(0,n.jsxs)(e.h4,{id:\"\\u914D\\u7F6E\",children:[(0,n.jsx)(e.a,{href:\"#\\u914D\\u7F6E\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u914D\\u7F6E\"]}),(0,n.jsx)(e.p,{children:\"\\u9996\\u5148\\u8BA9\\u6211\\u4EEC\\u901A\\u8FC7application.yml\\u914D\\u7F6E\\u670D\\u52A1\\u7AEF\\u53E3\\u4FE1\\u606F\\u548C\\u6570\\u636E\\u5E93\\u8FDE\\u63A5\\u4FE1\\u606F\\uFF1A\"}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"server\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"port\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8070\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"spring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"datasource\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"druid\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"db-type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` mysql\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"driver-class-name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` com.mysql.cj.jdbc.Driver\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"url\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" jdbc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"mysql\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"//localhost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"3306/persistence_oauth2_client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"?\"}),\"createDatabaseIfNotExist=true\",(0,n.jsx)(e.span,{className:\"token important\",children:\"\u0026useUnicode=true\u0026characterEncoding=UTF-8\u0026useSSL=false\u0026serverTimezone=Asia/Shanghai\u0026allowPublicKeyRetrieval=true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"username\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \u003c\u003cusername\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# \\u4FEE\\u6539\\u7528\\u6237\\u540D\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"password\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \u003c\u003cpassword\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# \\u4FEE\\u6539\\u5BC6\\u7801\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u63A5\\u4E0B\\u6765\\u6211\\u4EEC\\u6839\\u636E\",(0,n.jsx)(e.code,{children:\"ClientRegistration\"}),\"\\u6765\\u521B\\u5EFA\\u6570\\u636E\\u5E93\\u8868\\u7528\\u4E8E\\u5B58\\u50A8OAuth2\\u5BA2\\u6237\\u7AEF\\u4FE1\\u606F\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-sql\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-sql\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"CREATE\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"TABLE\"}),\" \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"oauth2_registered_client\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"registration_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                 \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"client_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                       \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"client_secret\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                   \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"client_authentication_method\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"authorization_grant_type\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"client_name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                     \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"redirect_uri\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"scopes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                          \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"authorization_uri\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"               \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"token_uri\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                       \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"jwk_set_uri\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                     \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"issuer_uri\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                      \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"user_info_uri\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"                   \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"user_info_authentication_method\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"user_name_attribute_name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"configuration_metadata\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),\"          \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"PRIMARY\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"KEY\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token identifier\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"}),\"registration_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"`\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"ENGINE\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"InnoDB\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"CHARSET\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"utf8mb4 \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"COLLATE\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"utf8mb4_0900_ai_ci\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4E0B\\u9762\\u5C06\\u662F\\u6211\\u4EEC\\u901A\\u8FC7\\u5B9E\\u73B0\",(0,n.jsx)(e.em,{children:\"ClientRegistrationRepository\"}),\"\\u6269\\u5C55\\u7684\",(0,n.jsx)(e.em,{children:\"JdbcClientRegistrationRepository\"}),\"\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcClientRegistrationRepository\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationRepository\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"COLUMN_NAMES\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"registration_id,client_id,client_secret,client_authentication_method,authorization_grant_type,client_name,redirect_uri,scopes,authorization_uri,token_uri,jwk_set_uri,issuer_uri,user_info_uri,user_info_authentication_method,user_name_attribute_name,configuration_metadata\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"TABLE_NAME\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"oauth2_registered_client\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"LOAD_CLIENT_REGISTERED_SQL\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"SELECT \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"COLUMN_NAMES\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\" FROM \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"TABLE_NAME\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\" WHERE \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"INSERT_CLIENT_REGISTERED_SQL\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"INSERT INTO \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"TABLE_NAME\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"(\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"COLUMN_NAMES\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\") VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"UPDATE_CLIENT_REGISTERED_SQL\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"UPDATE \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"TABLE_NAME\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\" SET client_id = ?,client_secret = ?,client_authentication_method = ?,authorization_grant_type = ?,client_name = ?,redirect_uri = ?,scopes = ?,authorization_uri = ?,token_uri = ?,jwk_set_uri = ?,issuer_uri = ?,user_info_uri = ?,user_info_authentication_method = ?,user_name_attribute_name = ? WHERE registration_id = ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcOperations\"}),\" jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"RowMapper\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" clientRegistrationRowMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Function\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SqlParameterValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" clientRegistrationListParametersMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcClientRegistrationRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcOperations\"}),\" jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Assert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"notNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"JdbcOperations can not be null\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"jdbcOperations \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clientRegistrationRowMapper \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationRowMapper\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clientRegistrationListParametersMapper \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationParametersMapper\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Override\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"findByRegistrationId\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" registrationId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Assert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"hasText\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"registrationId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"registrationId cannot be empty\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"findBy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"registration_id = ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" registrationId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"findBy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" filter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Object\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" result \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"query\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"LOAD_CLIENT_REGISTERED_SQL\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" filter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clientRegistrationRowMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"isEmpty\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\" result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"save\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),\" clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Assert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"notNull\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"clientRegistration cannot be null\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),\" existingClientRegistration \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"findByRegistrationId\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getRegistrationId\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"existingClientRegistration \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"updateRegisteredClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"insertClientRegistration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"updateRegisteredClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),\" clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SqlParameterValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" parameterValues \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clientRegistrationListParametersMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"apply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PreparedStatementSetter\"}),\" statementSetter \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ArgumentPreparedStatementSetter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"parameterValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"toArray\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"update\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"UPDATE_CLIENT_REGISTERED_SQL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" statementSetter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"insertClientRegistration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistration\"}),\" clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SqlParameterValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" parameterValues \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clientRegistrationListParametersMapper\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"apply\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PreparedStatementSetter\"}),\" statementSetter \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ArgumentPreparedStatementSetter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"parameterValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"toArray\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"jdbcOperations\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"update\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"INSERT_CLIENT_REGISTERED_SQL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" statementSetter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//...\\u7701\\u7565\\u90E8\\u5206\\u4EE3\\u7801\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4E4B\\u540E\\u6211\\u4EEC\\u5C06\\u521B\\u5EFA\",(0,n.jsx)(e.code,{children:\"SecurityConfig\"}),\"\\u5B89\\u5168\\u914D\\u7F6E\\u7C7B\\uFF0C\\u5728\\u6B64\\u7C7B\\u4E2D\\u521B\\u5EFAOAuth2 Client\\u6240\\u9700\\u7279\\u5B9A\\u7684Bean\\u3002\\u9996\\u5148\\u6211\\u4EEC\\u5C06\\u5B9E\\u4F8B\\u5316\\u4E0A\\u8FF0\\u81EA\\u5B9A\\u4E49\\u7684\",(0,n.jsx)(e.em,{children:\"JdbcClientRegistrationRepository\"}),\"\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationRepository\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"clientRegistrationRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcTemplate\"}),\" jdbcTemplate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcClientRegistrationRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"jdbcTemplate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"ClientRegistration\"}),\"\\uFF1A\\u8868\\u793A\\u4F7F\\u7528 OAuth 2.0 \\u6216 OpenID Connect (OIDC) \\u6CE8\\u518C\\u7684\\u5BA2\\u6237\\u7AEF\\u3002\\u5B83\\u5305\\u542B\\u6709\\u5173\\u5BA2\\u6237\\u7AEF\\u7684\\u6240\\u6709\\u57FA\\u672C\\u4FE1\\u606F\\uFF0C\\u4F8B\\u5982\\u5BA2\\u6237\\u7AEF ID\\u3001\\u5BA2\\u6237\\u7AEF\\u673A\\u5BC6\\u3001\\u6388\\u6743\\u7C7B\\u578B\\u548C\\u5404\\u79CD URI\\u3002\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"ClientRegistrationRepository\"}),\"\\uFF1A\\u8FD9\\u662F\\u4E00\\u4E2A\\u5305\\u542B\",(0,n.jsx)(e.em,{children:\"ClientRegistrations\"}),\"\\u5E76\\u8D1F\\u8D23\\u6301\\u4E45\\u5316\\u3002\"]}),(0,n.jsx)(\"br\",{}),(0,n.jsxs)(e.p,{children:[\"\\u63A5\\u4E0B\\u6765\\u914D\\u7F6EOAuth2AuthorizedClient\\u7BA1\\u7406\\u7C7B\",(0,n.jsx)(e.em,{children:\"OAuth2AuthorizedClientService\"}),\"\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientService\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"authorizedClientService\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcTemplate\"}),\" jdbcTemplate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationRepository\"}),\" clientRegistrationRepository\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JdbcOAuth2AuthorizedClientService\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"jdbcTemplate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" clientRegistrationRepository\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"OAuth2AuthorizedClient\"}),\"\\uFF1A\\u8868\\u793A\\u6388\\u6743\\u5BA2\\u6237\\u7AEF\\u3002\\u8FD9\\u662F\\u4E00\\u4E2A\\u5305\\u542B\\u5BA2\\u6237\\u7AEF\\u6CE8\\u518C\\u4F46\\u6DFB\\u52A0\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u4FE1\\u606F\\u7684\\u7EC4\\u5408\\u7C7B\\u3002\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"OAuth2AuthorizedClientService\"}),\"\\uFF1A\\u8D1F\\u8D23\",(0,n.jsx)(e.code,{children:\"OAuth2AuthorizedClient\"}),\"\\u5728 Web \\u8BF7\\u6C42\\u4E4B\\u95F4\\u8FDB\\u884C\\u6301\\u4E45\\u5316\\u3002\"]}),(0,n.jsx)(\"br\",{}),(0,n.jsxs)(e.p,{children:[\"\\u5B9A\\u4E49\",(0,n.jsx)(e.em,{children:\"JdbcOAuth2AuthorizedClientService\"}),\"\\u9700\\u8981\\u521B\\u5EFA\\u6240\\u9700\\u6570\\u636E\\u8868\\uFF0C\\u4F60\\u53EF\\u4EE5\\u5728\",(0,n.jsx)(e.a,{href:\"https://docs.spring.io/spring-security/site/docs/5.4.5/reference/html5/#dbschema-oauth2-client\",children:\"OAuth2 Client Schema\"}),\"\\u4E2D\\u83B7\\u53D6\\u8868\\u5B9A\\u4E49\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-sql\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-sql\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"CREATE\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"TABLE\"}),` oauth2_authorized_client\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    client_registration_id  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"                            \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    principal_name          \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"                            \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    access_token_type       \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"                            \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    access_token_value      \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"blob\"}),\"                                    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    access_token_issued_at  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"timestamp\"}),\"                               \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    access_token_expires_at \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"timestamp\"}),\"                               \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    access_token_scopes     \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"varchar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    refresh_token_value     \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"blob\"}),\"          \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    refresh_token_issued_at \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"timestamp\"}),\"     \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    created_at              \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"timestamp\"}),\"     \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"DEFAULT\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"CURRENT_TIMESTAMP\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"PRIMARY\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"KEY\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"client_registration_id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" principal_name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u63A5\\u4E0B\\u6765\\u914D\\u7F6E\",(0,n.jsx)(e.em,{children:\"OAuth2AuthorizedClientRepository\"}),\"\\u5BB9\\u5668\\u7C7B\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientRepository\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"authorizedClientRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientService\"}),\" authorizedClientService\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"AuthenticatedPrincipalOAuth2AuthorizedClientRepository\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"authorizedClientService\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"OAuth2AuthorizedClientRepository\"}),\":\\u662F\\u4E00\\u4E2A\\u5BB9\\u5668\\u7C7B\\uFF0C\\u7528\\u4E8E\\u5728\\u8BF7\\u6C42\\u4E4B\\u95F4\\u4FDD\\u5B58\\u548C\\u6301\\u4E45\\u5316\\u6388\\u6743\\u5BA2\\u6237\\u7AEF\\u3002\\u8FD9\\u91CC\\u901A\\u8FC7\",(0,n.jsx)(e.em,{children:\"JdbcOAuth2AuthorizedClientService\"}),\"\\u5C06\\u5BA2\\u6237\\u7AEF\\u5B58\\u50A8\\u5728\\u6570\\u636E\\u5E93\\u4E2D\\u3002\"]}),(0,n.jsx)(\"br\",{}),(0,n.jsx)(e.p,{children:\"\\u63A5\\u4E0B\\u6765\\u5B9E\\u4F8B\\u5316\\u5305\\u542B\\u6388\\u6743\\u6D41\\u7A0B\\u7684\\u903B\\u8F91\\u7684\\u7BA1\\u7406\\u5668\\u7C7B\\uFF1A\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientManager\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"authorizedClientManager\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ClientRegistrationRepository\"}),\" clientRegistrationRepository\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                                                      \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientRepository\"}),\" authorizedClientRepository\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientProvider\"}),\" authorizedClientProvider \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClientProviderBuilder\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"builder\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"authorizationCode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"refreshToken\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"build\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"DefaultOAuth2AuthorizedClientManager\"}),\" authorizedClientManager \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"DefaultOAuth2AuthorizedClientManager\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clientRegistrationRepository\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" authorizedClientRepository\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  authorizedClientManager\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setAuthorizedClientProvider\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"authorizedClientProvider\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" authorizedClientManager\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"OAuth2AuthorizedClientManager\"}),\"\\uFF1A\\u662F\\u5305\\u542B\\u5904\\u7406\\u6388\\u6743\\u6D41\\u7A0B\\u7684\\u903B\\u8F91\\u7684\\u7BA1\\u7406\\u5668\\u7C7B\\u3002\\u6700\\u91CD\\u8981\\u7684\\u662F\\uFF0C\\u5B83\\u4F7F\\u7528\",(0,n.jsx)(e.code,{children:\"OAuth2AuthorizedClientProvider\"}),\"\\u5904\\u7406\\u4E0D\\u540C\\u6388\\u6743\\u7C7B\\u578B\\u548C OAuth 2.0 \\u63D0\\u4F9B\\u8005\\u7684\\u5B9E\\u9645\\u8BF7\\u6C42\\u903B\\u8F91\\u3002\\u5B83\\u8FD8\\u59D4\\u6258\",(0,n.jsx)(e.code,{children:\"OAuth2AuthorizedClientRepository\"}),\"\\u5728\\u5BA2\\u6237\\u7AEF\\u6388\\u6743\\u6210\\u529F\\u6216\\u5931\\u8D25\\u65F6\\u8C03\\u7528\\u6210\\u529F\\u6216\\u5931\\u8D25\\u5904\\u7406\\u7A0B\\u5E8F\\u3002\"]}),(0,n.jsx)(\"br\",{}),(0,n.jsx)(e.p,{children:\"\\u73B0\\u5728\\u8BA9\\u6211\\u4EEC\\u521B\\u5EFA\\u4E00\\u4E2AWebClient\\u5B9E\\u4F8B\\u7528\\u4E8E\\u5411\\u8D44\\u6E90\\u670D\\u52A1\\u5668\\u6267\\u884CHTTP\\u8BF7\\u6C42\\uFF1A\"}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:` @Bean\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    WebClient webClient(OAuth2AuthorizedClientManager authorizedClientManager) {\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        ServletOAuth2AuthorizedClientExchangeFilterFunction oauth2Client = new ServletOAuth2AuthorizedClientExchangeFilterFunction(authorizedClientManager);\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        return WebClient.builder()\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                .apply(oauth2Client.oauth2Configuration())\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                .build();\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    }\n`})]})}),(0,n.jsx)(\"br\",{}),(0,n.jsx)(e.p,{children:\"\\u6700\\u540E\\uFF0C\\u6211\\u4EEC\\u5C06\\u914D\\u7F6ESpring Security\\u5B89\\u5168\\u914D\\u7F6E\\uFF1A\"}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:` @Bean\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        http\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                .authorizeRequests(authorizeRequests -\u003e\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                        authorizeRequests.anyRequest().authenticated()\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                )\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                .formLogin(login -\u003e {\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                    login.loginPage(\"/login\").permitAll();\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                })\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`                .oauth2Client(withDefaults());\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        return http.build();\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    }\n`})]})}),(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u91CC\\u914D\\u7F6E\\u6240\\u6709\\u8BF7\\u6C42\\u9700\\u8981\\u8BA4\\u8BC1\\u6388\\u6743\\uFF0C\\u63D0\\u4F9BForm\\u8868\\u5355\\u8BA4\\u8BC1\\u65B9\\u5F0F\\uFF0C\\u5E76\\u901A\\u8FC7\",(0,n.jsx)(e.a,{href:\"https://www.thymeleaf.org/\",children:\"thymeleaf\"}),\"\\u81EA\\u5B9A\\u4E49\\u767B\\u5F55\\u6A21\\u7248\\uFF0C\\u6B64\\u5904\\u4EE3\\u7801\\u5E76\\u4E0D\\u518D\\u672C\\u6587\\u8BB2\\u89E3\\u8303\\u56F4\\u5185\\uFF0C\\u4EE5\\u4E0B\\u5C06\\u4E0D\\u5C55\\u793A\\u5177\\u4F53\\u7EC6\\u8282\\u3002\"]}),(0,n.jsxs)(e.h4,{id:\"\\u8BBF\\u95EE\\u8D44\\u6E90\\u5217\\u8868\",children:[(0,n.jsx)(e.a,{href:\"#\\u8BBF\\u95EE\\u8D44\\u6E90\\u5217\\u8868\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u8BBF\\u95EE\\u8D44\\u6E90\\u5217\\u8868\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6211\\u4EEC\\u5C06\\u521B\\u5EFA\\u4E00\\u4E2A\",(0,n.jsx)(e.em,{children:\"PersistenceClientController\"}),\"\\uFF0C\\u5E76\\u4F7F\\u7528WebClient\\u5411\\u8D44\\u6E90\\u670D\\u52A1\\u5668\\u53D1\\u8D77HTTP\\u8BF7\\u6C42\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@RestController\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PersistenceClientController\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@Autowired\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"WebClient\"}),\" webClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@GetMapping\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/client/test\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"getArticles\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation annotation\",children:\"@RegisteredOAuth2AuthorizedClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"messaging-client-authorization-code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"OAuth2AuthorizedClient\"}),\" authorizedClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`webClient\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"uri\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"http://127.0.0.1:8090/resource/article\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"attributes\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"oauth2AuthorizedClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"authorizedClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"retrieve\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"bodyToMono\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"block\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(\"br\",{}),(0,n.jsxs)(e.p,{children:[\"\\u5728\\u672C\\u6587\\u4E2D\\uFF0C\\u60A8\\u770B\\u5230\\u4E86OAuth2\\u5BA2\\u6237\\u7AEF\\u670D\\u52A1\\u6301\\u4E45\\u5316\\u5230\\u6570\\u636E\\u5E93\\u7684\\u5B9E\\u73B0\\u65B9\\u6CD5\\uFF0C\\u5BF9\\u4E8E\\u5176\\u4ED6\\u6388\\u6743\\u670D\\u52A1\\u5668\\u548C\\u8D44\\u6E90\\u670D\\u52A1\\u5668\\u914D\\u7F6E\\u5C06\\u4E0D\\u518D\\u8BB2\\u89E3\\uFF0C\\u5982\\u679C\\u60A8\\u611F\\u5174\\u8DA3\\u53EF\\u4EE5\\u53C2\\u8003 \\u6B64\\u6587\\u7AE0\",(0,n.jsx)(e.a,{href:\"https://relive27.github.io/2022/06/26/spring-security-oauth2-jwt/\",children:\"\\u5C06JWT\\u4E0ESpring Security OAuth2\\u7ED3\\u5408\\u4F7F\\u7528\"}),\"\\u3002\"]}),(0,n.jsxs)(e.h3,{id:\"\\u7ED3\\u8BBA\",children:[(0,n.jsx)(e.a,{href:\"#\\u7ED3\\u8BBA\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u7ED3\\u8BBA\"]}),(0,n.jsxs)(e.p,{children:[\"\\u4E0E\\u5F80\\u5E38\\u4E00\\u6837\\uFF0C\\u672C\\u6587\\u4E2D\\u4F7F\\u7528\\u7684\\u6E90\\u4EE3\\u7801\\u53EF\",(0,n.jsx)(e.a,{href:\"https://github.com/ReLive27/spring-security-oauth2-sample/tree/main/oauth2-persistence-client\",children:\"\\u5728 GitHub \\u4E0A\"}),\"\\u83B7\\u5F97\\u3002\"]})]})}}var b=w;return R;})();\n;return Component;","toc":[{"value":"Spring Security 持久化OAuth2客户端","url":"#spring-security-持久化oauth2客户端","depth":2},{"value":"OAuth2客户端服务实现","url":"#oauth2客户端服务实现","depth":3},{"value":"maven","url":"#maven","depth":4},{"value":"配置","url":"#配置","depth":4},{"value":"访问资源列表","url":"#访问资源列表","depth":4},{"value":"结论","url":"#结论","depth":3}],"frontMatter":{"readingTime":{"text":"10 min read","minutes":9.57,"time":574200,"words":1914},"slug":"persisrence-oauth2-client","fileName":"persisrence-oauth2-client.mdx","title":"Spring Security 持久化OAuth2客户端","date":"2022-07-03T11:55:25.000Z","tags":["OAuth2","SpringSecurity"],"draft":false,"authors":["default"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.37,"time":22200,"words":74},"slug":["default"],"fileName":"default.md","name":"ReLive27","avatar":"/static/images/avatar.png","occupation":"Intermediate Software Engineer","date":null}],"prev":{"title":"自定义OAuth2授权同意页面","date":"2022-06-28T19:40:29.000Z","tags":["SpringSecurity","OAuth2"],"draft":false,"authors":["default"],"slug":"custom-oauth2-consent-page"},"next":{"title":"Spring Security OAuth2客户端凭据授权","date":"2022-07-09T18:22:26.000Z","tags":["SpringSecurity","OAuth2"],"draft":false,"authors":["default"],"slug":"oauth2-client-model"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["persisrence-oauth2-client"]},"buildId":"qOb3mFNpU4K4sfK66WJU7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>